\comment{\subsection{Some results}
\label{sec:results}

We now study three aspects of our algorithm. First, we study the spatial distributions of domain boundary nodes obtained from Algorithm \ref{alg:ss_decim}. Next, we explore the influence of the Poisson neighborhood size $\hat{k}$ on the spatial distributions of interior nodes obtained from Algorithm \ref{alg:pds}. Finally, we explore the effect of the Poisson neighborhood size $\hat{k}$ on the errors in an RBF-FD discretization of the heat equation with Neumann boundary conditions.

\subsubsection{Spatial distribution of boundary nodes}
\label{sec:res_hist1}
\begin{figure}[h!]
\centering
\subfloat[Naive parametric sampling]
{
	\includegraphics[scale=0.2]{"Figures/naive_star_bdry".pdf} 	
	\label{fig:ps1a}
}
\subfloat[Sampling by Algorithm \ref{alg:ss_decim}]
{
	\includegraphics[scale=0.2]{"Figures/poisson_star_bdry".pdf}
	
	\label{fig:ps1b}
}

\subfloat[Histogram for $h=0.005$ (naive sampling)]
{
	\includegraphics[scale=0.4]{"Figures/star_h_0005_bdry_naive".pdf} 	
	\label{fig:ps1c}
}
\subfloat[Histogram for $h=0.005$ (Algorithm \ref{alg:ss_decim})]
{
	\includegraphics[scale=0.4]{"Figures/star_h_0005_bdry".pdf}
	
	\label{fig:ps1d}
}
\caption{Comparison of surface sampling techniques for the star domain using supersampling parameter $\tau = 2$.}
\label{fig:poisson_surf1}	
\end{figure}
We first explore the effect of Algorithm \ref{alg:ss_decim} on the node distributions produced on surfaces, and compare it to a naive sampling of the parametric map. To briefly illustrate the efficacy of this procedure, we sample two functions whose maps from parametric space to Cartesian space are likely to produce distorted point sets. The 2D shape is given by the following finitely-smooth function:
\begin{align}
r(\lambda) = |\cos(1.5 \lambda)|^{\sin(3 \lambda)}, \\
x(\lambda) = r(\lambda)\cos(\lambda), y(\lambda) = r(\lambda)\sin(\lambda),
\end{align} 
where $\lambda \in [0,2\pi)$. The 3D shape is a classic Red Blood Cell (RBC) shape, obtained by distorting the sphere~\cite{FuselierWright2013}. For this test, we interpolate the star shape with the SBF interpolant at $N_d = 128$ points and attempt to generate Cartesian samples with an average node spacing of $h = 0.005$. We interpolate the 3D shape with the SBF interpolant at $N_d = 700$ points, and attempt to generate Cartesian samples with an average node spacing of $h = 0.05$. The resulting node sets and their histograms are shown in Figures \ref{fig:poisson_surf1} and \ref{fig:poisson_surf2}. 
\begin{figure}[h!]
\centering
\subfloat[Naive parametric sampling]
{
	\includegraphics[scale=0.3]{"Figures/naive_rbc_bdry".pdf} 	
	\label{fig:ps2a}
}
\subfloat[Sampling by Algorithm \ref{alg:ss_decim}]
{
	\includegraphics[scale=0.3]{"Figures/poisson_rbc_bdry".pdf} 	
	\label{fig:ps2b}
}

\subfloat[Histogram for $h=0.05$ (naive sampling)]
{
	\includegraphics[scale=0.4]{"Figures/rbc_h_005_bdry_naive".pdf} 	
	\label{fig:ps2c}
}
\subfloat[Histogram for $h=0.05$ (Algorithm \ref{alg:ss_decim})]
{
	\includegraphics[scale=0.4]{"Figures/rbc_h_005_bdry".pdf}	
	\label{fig:ps2d}
}
\caption{Comparison of surface sampling techniques for the red blood cell domain using supersampling parameter $\tau = 2$.}
\label{fig:poisson_surf2}	
\end{figure}
Figure \ref{fig:ps1a} clearly shows the clustering induced by the parametric map for the star domain, corroborated by the histogram in Figure \ref{fig:ps1c} which shows a large number of nodes with a distance of $h=0.0025$ to the nearest neighbor, rather than the desired $h=0.005$. Further, examining the histogram, we see that the nodes are also sometimes very far apart (as far apart as $h=0.02$). In contrast, Algorithm \ref{alg:ss_decim} produces much more uniform node sets. This can be verified visually (Figure \ref{fig:ps1b}), and from the corresponding histogram (Figure \ref{fig:ps1d}). In this case, the histogram shows the most number of nodes in the bin corresponding to $h=0.005$, with exponentially fewer nodes in bins corresponding to larger $h$ values.  

Unlike in the star domain, the 3D results in Figures \ref{fig:ps2a} and \ref{fig:ps2b} are more ambiguous in the eye norm. While the latter appears visually more uniform than the former, the difference does not appear to be quite as striking as in the case of the star domain. However, the histograms illustrate that the differences in 3D are stark as well. Figure \ref{fig:ps2c} shows that most nodes are in a bin close to $h=0.03$, but are distributed over a relatively wide range. Further, with naive sampling, there appear to be no nodes whatsoever in the $h=0.05$ bin! In marked contrast, the histogram in Figure \ref{fig:ps2d} (corresponding to sampling by Algorithm \ref{alg:ss_decim}) shows the most number of nodes in the $h=0.05$ bin (as desired), with fewer nodes in bins corresponding to larger $h$ values. While the fall-off of numbers of nodes in bins with larger $h$ is not quite as uniform as in the 2D case, Algorithm \ref{alg:ss_decim} still appears to produce fairly uniform node sets.

\subsubsection{Spatial distribution of interior nodes}
\label{sec:res_hist2}
\begin{figure}[h!]
\centering
\subfloat[Star, $\hat{k}=15$, $h=0.005$]
{
	\includegraphics[scale=0.4]{"Figures/star_k15_h_0005_int".pdf}
	
	\label{fig:h1a}
}
\subfloat[Star, $\hat{k}=45$, $h=0.005$]
{
	\includegraphics[scale=0.4]{"Figures/star_k45_h_0005_int".pdf} 	
	\label{fig:h1b}
}

\subfloat[Red blood cell, $\hat{k}=15$, $h=0.05$]
{
	\includegraphics[scale=0.4]{"Figures/rbc_k15_h_005_int".pdf}
	
	\label{fig:h1c}
}
\subfloat[Red blood cell, $\hat{k}=45$, $h=0.05$]
{
	\includegraphics[scale=0.4]{"Figures/rbc_k45_h_005_int".pdf} 	
	\label{fig:h1d}
}
\caption{Histograms of node sets generated by Algorithm \ref{alg:node_gen_1} in the interiors of the star domain (top row) and the red blood cell domain (bottom row) as a function of the Poisson neighborhood size $\hat{k}$.}
\label{fig:hist2d1}	
\end{figure}
We turn our attention to the node sets produced by Algorithm \ref{alg:node_gen_1} in the interiors of domains. Recall that this is accomplished by applying Algorithm \ref{alg:pds} in the domain bounding box to obtain $N_{obb}$ nodes, then eliminating those nodes that lie outside the parametric SBF interpolant to the boundary. It is important to note that Algorithm \ref{alg:pds} utilizes the Poisson neighborhood size $\hat{k}$ parameter to a computational complexity of $O(N_{obb})$. However, $\hat{k}$ also determines the number of nodes against which samples are compared to specify the desired separation distance $h$. One could imagine setting $\hat{k} = N_{obb}$ to obtain a perfectly-spaced set of nodes, and obtaining a complexity of $O(N_{obb}^2)$ for node generation. Since $\hat{k}$ controls both computational cost and spatial distribution, it is important to understand the effect of this parameter on spatial distributions of nodes. To explore the impact of $\hat{k}$, we compute histograms of distances to the nearest neighbor for node sets in the interior of the star domain with $h=0.005$ (2D), and the red blood cell with $h=0.05$ (3D). The results are shown in Figure \ref{fig:hist2d1}.

From Figure \ref{fig:hist2d1}, it is clear that Algorithm \ref{alg:node_gen_1} produces node sets that are very close to uniform. Most nodes lie in the desired bins of $h=0.005$ (in 2D) and $h=0.05$ (in 3D), and the number of nodes in bins corresponding to larger values of $h$ drops off exponentially in both 2D and 3D. Very similar node distributions were obtained when objects were embedded within (results not shown).

\subsubsection{Errors in RBF-FD discretizations}
\label{sec:res_err}
\begin{figure}[h!]
\centering
\subfloat[Convergence rates for $\hat{k}=15$]
{
	\includegraphics[scale=0.5]{"Figures/rbc_k15_conv".pdf}
	
	\label{fig:csa}
}
\subfloat[Convergence rates for $\hat{k}=45$]
{
	\includegraphics[scale=0.5]{"Figures/rbc_k45_conv".pdf} 	
	\label{fig:csb}
}
\caption{Errors in the solution to \eqref{eq:heat1}--\eqref{eq:heat2} in the red blood cell domain as a function of the stencil size $n$, number of nodes $N$, polynomial degree $\ell$, and Poisson neighborhood size $\hat{k}$.}
\label{fig:conv_study}	
\end{figure}
The goal of this article was to design a node generator that produces node sets suitable for RBF-FD discretizations. In this section, we provide some evidence as to that suitability by exploring the effects of the parameter $\hat{k}$ on the errors and convergence rates from RBF-FD discretizations of the heat equation
\begin{align}
\frac{\partial c(\vx,t)}{\partial t} &= \Delta c + f(\vx,t), \vx \in \Omega,\label{eq:heat1}\\
\frac{\partial c(\vx,t)}{\partial \vn} &= g(\vx,t), \vx \in \gamma, \label{eq:heat2}
\end{align}
where $\Omega$ is the red blood cell domain seen earlier, and $\gamma$ is its curved boundary. We have restricted ourselves to a 3D test for brevity. To measure convergence rates, we manufacture a solution to the heat equation by prescribing $c(\vx,t)$, then computing a corresponding $f(\vx,t)$ and $g(\vx,t)$ that make the prescribed solution hold. We use the infinitely-smooth ansatz:
\begin{align}
c(\vx,t) = c(x,y,z,t) = 1 + \sin(\pi x)\cos(\pi y)\sin(\pi z) e^{-\pi t}.
\end{align}
For the spatial discretization, we use the overlapped RBF-FD method~\cite{ShankarJCP2017}, and the ghost node technique outlined in~\cite{SFJCP2018}. The RBF-FD discretization is achieved by using PHS RBFs in conjunction with high-degree polynomials, where the convergence rates are dictated purely by the polynomial degree~\cite{FlyerPHS,FlyerNS,BarnettPHS}. Since these discretization techniques are explained in detail in the references, we restrict ourselves to a description of our results. Primarily, when increasing the RBF-FD stencil size $n$ and consequently the polynomial degree $\ell$, we expect to see higher-orders of convergence. We run these convergence studies and report $\ell_2$ errors in the numerical solution for different values of $n$, $\ell$, $\hat{k}$, and $h \propto \frac{1}{\sqrt[3]{N}}$. The results are shown in Figure \ref{fig:conv_study}. Studying Figures \ref{fig:csa} and \ref{fig:csb} closely, we see slightly different convergence rates between the two figures for the same stencil size and polynomial degree. From the data (not shown), the errors for $\hat{k} = 45$ appear to be slightly lower than the errors for $\hat{k} = 15$, but not significantly so at higher values of $N$. This is not surprising, given the similarity in the histograms for these two $\hat{k}$ values, but is reassuring since it indicates that we can use small values of $\hat{k}$ relative to $N$ and still achieve low errors and high orders of convergence on fairly irregular domains.

}%red comment
